<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1192px" preserveAspectRatio="none" style="width:800px;height:1192px;" version="1.1" viewBox="0 0 800 1192" width="800px" zoomAndPan="magnify"><defs><linearGradient id="g19jo8q2jqnk4l0" x1="0%" x2="100%" y1="50%" y2="50%"><stop offset="0%" stop-color="#FFFFFF"/><stop offset="100%" stop-color="#FFFFFF"/></linearGradient><filter height="300%" id="f19jo8q2jqnk4l" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="url(#g19jo8q2jqnk4l0)" height="1192" style="stroke: none; stroke-width: 1.0;" width="800" x="0" y="0"/><text fill="#000000" font-family="Roboto Condensed" font-size="18" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="166" x="316" y="28.8613">Nuspell - Result Cache</text><ellipse cx="287.5" cy="43.7393" fill="#000000" filter="url(#f19jo8q2jqnk4l)" rx="10" ry="10" style="stroke: none; stroke-width: 1.0;"/><path d="M443.5,69.5073 L443.5,87.6523 L423.5,91.6523 L443.5,95.6523 L443.5,113.7974 A0,0 0 0 0 443.5,113.7974 L680.5,113.7974 A0,0 0 0 0 680.5,113.7974 L680.5,79.5073 L670.5,69.5073 L443.5,69.5073 A0,0 0 0 0 443.5,69.5073 " fill="#FFFFFF" filter="url(#f19jo8q2jqnk4l)" style="stroke: #000000; stroke-width: 1.0;"/><path d="M670.5,69.5073 L670.5,79.5073 L680.5,79.5073 L670.5,69.5073 " fill="#FFFFFF" style="stroke: #000000; stroke-width: 1.0;"/><text fill="#000000" font-family="Roboto Condensed" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="216" x="449.5" y="88.1294">Use each cache for only on type of entries,</text><text fill="#000000" font-family="Roboto Condensed" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="163" x="449.5" y="105.2744">do not mix spell/suggest usage.</text><rect fill="#FFFFFF" filter="url(#f19jo8q2jqnk4l)" height="35.8262" rx="12.5" ry="12.5" style="stroke: #000000; stroke-width: 1.5;" width="272" x="151.5" y="73.7393"/><text fill="#000000" font-family="Roboto Condensed" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="252" x="161.5" y="96.3135">initialize cache for entry type and maximum entries</text><rect fill="#FFFFFF" filter="url(#f19jo8q2jqnk4l)" height="35.8262" rx="12.5" ry="12.5" style="stroke: #000000; stroke-width: 1.5;" width="340" x="117.5" y="196.3047"/><text fill="#000000" font-family="Roboto Condensed" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="320" x="127.5" y="218.8789">external request is received for spell/suggest for a word (the key)</text><rect fill="#FFFFFF" filter="url(#f19jo8q2jqnk4l)" height="261.9424" style="stroke: #000000; stroke-width: 2.0;" width="336" x="107.5" y="243.4248"/><path d="M344.5,244.4248 L344.5,254.8887 L334.5,264.8887 L107.5,264.8887 " fill="none" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="Roboto Condensed" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="227" x="110.5" y="259.0947">get the value for this key from the cache</text><polygon fill="#FFFFFF" filter="url(#f19jo8q2jqnk4l)" points="254.5,281.8887,320.5,281.8887,332.5,293.8887,320.5,305.8887,254.5,305.8887,242.5,293.8887,254.5,281.8887" style="stroke: #000000; stroke-width: 1.5;"/><text fill="#000000" font-family="Roboto Condensed" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="66" x="254.5" y="298.1614">cache has key?</text><text fill="#000000" font-family="Roboto Condensed" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="15" x="227.5" y="290.9077">yes</text><text fill="#000000" font-family="Roboto Condensed" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="11" x="332.5" y="290.9077">no</text><rect fill="#FFFFFF" filter="url(#f19jo8q2jqnk4l)" height="35.8262" rx="12.5" ry="12.5" style="stroke: #000000; stroke-width: 1.5;" width="101" x="158" y="315.8887"/><text fill="#000000" font-family="Roboto Condensed" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="81" x="168" y="338.4629">get value for key</text><rect fill="#FFFFFF" filter="url(#f19jo8q2jqnk4l)" height="35.8262" rx="12.5" ry="12.5" style="stroke: #000000; stroke-width: 1.5;" width="137" x="140" y="371.7148"/><text fill="#000000" font-family="Roboto Condensed" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="117" x="150" y="394.2891">increment count for key</text><rect fill="#FFFFFF" filter="url(#f19jo8q2jqnk4l)" height="35.8262" rx="12.5" ry="12.5" style="stroke: #000000; stroke-width: 1.5;" width="162" x="127.5" y="427.541"/><text fill="#000000" font-family="Roboto Condensed" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="142" x="137.5" y="450.1152">set timestamp for key to now</text><rect fill="#FFFFFF" filter="url(#f19jo8q2jqnk4l)" height="35.8262" rx="12.5" ry="12.5" style="stroke: #000000; stroke-width: 1.5;" width="114" x="309.5" y="315.8887"/><text fill="#000000" font-family="Roboto Condensed" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="94" x="319.5" y="338.4629">return empty result</text><polygon fill="#FFFFFF" filter="url(#f19jo8q2jqnk4l)" points="287.5,469.3672,299.5,481.3672,287.5,493.3672,275.5,481.3672,287.5,469.3672" style="stroke: #000000; stroke-width: 1.5;"/><polygon fill="#FFFFFF" filter="url(#f19jo8q2jqnk4l)" points="218.5,525.3672,356.5,525.3672,368.5,537.3672,356.5,549.3672,218.5,549.3672,206.5,537.3672,218.5,525.3672" style="stroke: #000000; stroke-width: 1.5;"/><text fill="#000000" font-family="Roboto Condensed" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="138" x="218.5" y="541.6399">a non-empty value got returned?</text><text fill="#000000" font-family="Roboto Condensed" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="15" x="191.5" y="534.3862">yes</text><text fill="#000000" font-family="Roboto Condensed" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="11" x="368.5" y="534.3862">no</text><rect fill="#FFFFFF" filter="url(#f19jo8q2jqnk4l)" height="51.6523" rx="12.5" ry="12.5" style="stroke: #000000; stroke-width: 1.5;" width="119" x="44" y="559.3672"/><text fill="#000000" font-family="Roboto Condensed" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="95" x="54" y="581.9414">return that value to</text><text fill="#000000" font-family="Roboto Condensed" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="99" x="54" y="597.7676">the external request</text><rect fill="#FFFFFF" filter="url(#f19jo8q2jqnk4l)" height="35.8262" rx="12.5" ry="12.5" style="stroke: #000000; stroke-width: 1.5;" width="275" x="334" y="559.3672"/><text fill="#000000" font-family="Roboto Condensed" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="255" x="344" y="581.9414">get the value from spell/suggest method for this key</text><rect fill="#000000" filter="url(#f19jo8q2jqnk4l)" height="6" rx="2.5" ry="2.5" style="stroke: #000000; stroke-width: 1.0;" width="577" x="183" y="630.1934"/><rect fill="#FFFFFF" filter="url(#f19jo8q2jqnk4l)" height="51.6523" rx="12.5" ry="12.5" style="stroke: #000000; stroke-width: 1.5;" width="119" x="197" y="870.9182"/><text fill="#000000" font-family="Roboto Condensed" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="95" x="207" y="893.4924">return that value to</text><text fill="#000000" font-family="Roboto Condensed" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="99" x="207" y="909.3186">the external request</text><rect fill="#FFFFFF" filter="url(#f19jo8q2jqnk4l)" height="445.8557" style="stroke: #000000; stroke-width: 2.0;" width="402" x="344" y="656.1934"/><path d="M568,657.1934 L568,667.6572 L558,677.6572 L344,677.6572 " fill="none" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="Roboto Condensed" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="214" x="347" y="671.8633">add the value for this key to the cache</text><path d="M592,747.592 L592,765.7371 L572,769.7371 L592,773.7371 L592,791.8821 A0,0 0 0 0 592,791.8821 L714,791.8821 A0,0 0 0 0 714,791.8821 L714,757.592 L704,747.592 L592,747.592 A0,0 0 0 0 592,747.592 " fill="#FFFFFF" filter="url(#f19jo8q2jqnk4l)" style="stroke: #000000; stroke-width: 1.0;"/><path d="M704,747.592 L704,757.592 L714,757.592 L704,747.592 " fill="#FFFFFF" style="stroke: #000000; stroke-width: 1.0;"/><text fill="#000000" font-family="Roboto Condensed" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="87" x="598" y="766.2141">Sorting key is for</text><text fill="#000000" font-family="Roboto Condensed" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="101" x="598" y="783.3591">constant behaviour.</text><rect fill="#FFFFFF" filter="url(#f19jo8q2jqnk4l)" height="51.6523" rx="12.5" ry="12.5" style="stroke: #000000; stroke-width: 1.5;" width="208" x="364" y="743.9109"/><text fill="#000000" font-family="Roboto Condensed" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="188" x="374" y="766.4851">get X cache entries with lowest count,</text><text fill="#000000" font-family="Roboto Condensed" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="174" x="374" y="782.3113">oldest timestamp and sorted on key</text><rect fill="#FFFFFF" filter="url(#f19jo8q2jqnk4l)" height="35.8262" rx="12.5" ry="12.5" style="stroke: #000000; stroke-width: 1.5;" width="118" x="409" y="825.1501"/><text fill="#000000" font-family="Roboto Condensed" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="98" x="419" y="847.7244">delete these entries</text><polygon fill="#FFFFFF" filter="url(#f19jo8q2jqnk4l)" points="419.5,694.6572,516.5,694.6572,528.5,706.6572,516.5,718.6572,419.5,718.6572,407.5,706.6572,419.5,694.6572" style="stroke: #000000; stroke-width: 1.5;"/><text fill="#000000" font-family="Roboto Condensed" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="15" x="472" y="730.1836">yes</text><text fill="#000000" font-family="Roboto Condensed" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="97" x="419.5" y="710.9299">cache is at maximum?</text><text fill="#000000" font-family="Roboto Condensed" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="11" x="528.5" y="703.6763">no</text><polygon fill="#FFFFFF" filter="url(#f19jo8q2jqnk4l)" points="468,886.23,480,898.23,468,910.23,456,898.23,468,886.23" style="stroke: #000000; stroke-width: 1.5;"/><rect fill="#FFFFFF" filter="url(#f19jo8q2jqnk4l)" height="35.8262" rx="12.5" ry="12.5" style="stroke: #000000; stroke-width: 1.5;" width="103" x="416.5" y="942.5706"/><text fill="#000000" font-family="Roboto Condensed" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="83" x="426.5" y="965.1448">add value for key</text><rect fill="#FFFFFF" filter="url(#f19jo8q2jqnk4l)" height="35.8262" rx="12.5" ry="12.5" style="stroke: #000000; stroke-width: 1.5;" width="124" x="406" y="998.3967"/><text fill="#000000" font-family="Roboto Condensed" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="104" x="416" y="1020.9709">set count for key to 1</text><rect fill="#FFFFFF" filter="url(#f19jo8q2jqnk4l)" height="35.8262" rx="12.5" ry="12.5" style="stroke: #000000; stroke-width: 1.5;" width="162" x="387" y="1054.2229"/><text fill="#000000" font-family="Roboto Condensed" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="142" x="397" y="1076.7971">set timestamp for key to now</text><rect fill="#000000" filter="url(#f19jo8q2jqnk4l)" height="6" rx="2.5" ry="2.5" style="stroke: #000000; stroke-width: 1.0;" width="577" x="183" y="1122.0491"/><polygon fill="#FFFFFF" filter="url(#f19jo8q2jqnk4l)" points="287.5,1134.0491,299.5,1146.0491,287.5,1158.0491,275.5,1146.0491,287.5,1134.0491" style="stroke: #000000; stroke-width: 1.5;"/><polygon fill="#FFFFFF" filter="url(#f19jo8q2jqnk4l)" points="238.5,133.7974,336.5,133.7974,348.5,145.7974,336.5,157.7974,238.5,157.7974,226.5,145.7974,238.5,133.7974" style="stroke: #000000; stroke-width: 1.5;"/><text fill="#000000" font-family="Roboto Condensed" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="15" x="291.5" y="169.3237">yes</text><text fill="#000000" font-family="Roboto Condensed" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="98" x="238.5" y="150.0701">application is running?</text><text fill="#000000" font-family="Roboto Condensed" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="11" x="215.5" y="142.8164">no</text><ellipse cx="24" cy="191.7974" fill="none" filter="url(#f19jo8q2jqnk4l)" rx="10" ry="10" style="stroke: #000000; stroke-width: 1.0;"/><ellipse cx="24.5" cy="192.2974" fill="#000000" filter="url(#f19jo8q2jqnk4l)" rx="6" ry="6" style="stroke: none; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="287.5" x2="287.5" y1="53.7393" y2="73.7393"/><polygon fill="#000000" points="283.5,63.7393,287.5,73.7393,291.5,63.7393,287.5,67.7393" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="208.5" x2="208.5" y1="351.7148" y2="371.7148"/><polygon fill="#000000" points="204.5,361.7148,208.5,371.7148,212.5,361.7148,208.5,365.7148" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="208.5" x2="208.5" y1="407.541" y2="427.541"/><polygon fill="#000000" points="204.5,417.541,208.5,427.541,212.5,417.541,208.5,421.541" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="242.5" x2="208.5" y1="293.8887" y2="293.8887"/><line style="stroke: #000000; stroke-width: 1.5;" x1="208.5" x2="208.5" y1="293.8887" y2="315.8887"/><polygon fill="#000000" points="204.5,305.8887,208.5,315.8887,212.5,305.8887,208.5,309.8887" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="332.5" x2="366.5" y1="293.8887" y2="293.8887"/><line style="stroke: #000000; stroke-width: 1.5;" x1="366.5" x2="366.5" y1="293.8887" y2="315.8887"/><polygon fill="#000000" points="362.5,305.8887,366.5,315.8887,370.5,305.8887,366.5,309.8887" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="208.5" x2="208.5" y1="463.3672" y2="481.3672"/><line style="stroke: #000000; stroke-width: 1.5;" x1="208.5" x2="275.5" y1="481.3672" y2="481.3672"/><polygon fill="#000000" points="265.5,477.3672,275.5,481.3672,265.5,485.3672,269.5,481.3672" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="366.5" x2="366.5" y1="351.7148" y2="481.3672"/><line style="stroke: #000000; stroke-width: 1.5;" x1="366.5" x2="299.5" y1="481.3672" y2="481.3672"/><polygon fill="#000000" points="309.5,477.3672,299.5,481.3672,309.5,485.3672,305.5,481.3672" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="287.5" x2="287.5" y1="232.1309" y2="281.8887"/><polygon fill="#000000" points="283.5,271.8887,287.5,281.8887,291.5,271.8887,287.5,275.8887" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="468" x2="468" y1="795.5632" y2="825.1501"/><polygon fill="#000000" points="464,815.1501,468,825.1501,472,815.1501,468,819.1501" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="468" x2="468" y1="718.6572" y2="743.9109"/><polygon fill="#000000" points="464,733.9109,468,743.9109,472,733.9109,468,737.9109" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="528.5" x2="724" y1="706.6572" y2="706.6572"/><polygon fill="#000000" points="720,795.1501,724,805.1501,728,795.1501,724,799.1501" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="724" x2="724" y1="706.6572" y2="898.23"/><line style="stroke: #000000; stroke-width: 1.5;" x1="724" x2="480" y1="898.23" y2="898.23"/><polygon fill="#000000" points="490,894.23,480,898.23,490,902.23,486,898.23" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="468" x2="468" y1="860.9763" y2="886.23"/><polygon fill="#000000" points="464,876.23,468,886.23,472,876.23,468,880.23" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="468" x2="468" y1="910.23" y2="942.5706"/><polygon fill="#000000" points="464,932.5706,468,942.5706,472,932.5706,468,936.5706" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="468" x2="468" y1="978.3967" y2="998.3967"/><polygon fill="#000000" points="464,988.3967,468,998.3967,472,988.3967,468,992.3967" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="468" x2="468" y1="1034.2229" y2="1054.2229"/><polygon fill="#000000" points="464,1044.2229,468,1054.2229,472,1044.2229,468,1048.2229" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="256.5" x2="256.5" y1="636.1934" y2="870.9182"/><polygon fill="#000000" points="252.5,860.9182,256.5,870.9182,260.5,860.9182,256.5,864.9182" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="468" x2="468" y1="636.1934" y2="694.6572"/><polygon fill="#000000" points="464,684.6572,468,694.6572,472,684.6572,468,688.6572" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="256.5" x2="256.5" y1="922.5706" y2="1122.0491"/><polygon fill="#000000" points="252.5,1112.0491,256.5,1122.0491,260.5,1112.0491,256.5,1116.0491" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="468" x2="468" y1="1090.0491" y2="1122.0491"/><polygon fill="#000000" points="464,1112.0491,468,1122.0491,472,1112.0491,468,1116.0491" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="471.5" x2="471.5" y1="595.1934" y2="630.1934"/><polygon fill="#000000" points="467.5,620.1934,471.5,630.1934,475.5,620.1934,471.5,624.1934" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="206.5" x2="103.5" y1="537.3672" y2="537.3672"/><line style="stroke: #000000; stroke-width: 1.5;" x1="103.5" x2="103.5" y1="537.3672" y2="559.3672"/><polygon fill="#000000" points="99.5,549.3672,103.5,559.3672,107.5,549.3672,103.5,553.3672" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="368.5" x2="471.5" y1="537.3672" y2="537.3672"/><line style="stroke: #000000; stroke-width: 1.5;" x1="471.5" x2="471.5" y1="537.3672" y2="559.3672"/><polygon fill="#000000" points="467.5,549.3672,471.5,559.3672,475.5,549.3672,471.5,553.3672" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="103.5" x2="103.5" y1="611.0195" y2="1146.0491"/><line style="stroke: #000000; stroke-width: 1.5;" x1="103.5" x2="275.5" y1="1146.0491" y2="1146.0491"/><polygon fill="#000000" points="265.5,1142.0491,275.5,1146.0491,265.5,1150.0491,269.5,1146.0491" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="471.5" x2="471.5" y1="1128.0491" y2="1146.0491"/><line style="stroke: #000000; stroke-width: 1.5;" x1="471.5" x2="299.5" y1="1146.0491" y2="1146.0491"/><polygon fill="#000000" points="309.5,1142.0491,299.5,1146.0491,309.5,1150.0491,305.5,1146.0491" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="287.5" x2="287.5" y1="493.3672" y2="525.3672"/><polygon fill="#000000" points="283.5,515.3672,287.5,525.3672,291.5,515.3672,287.5,519.3672" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="287.5" x2="287.5" y1="157.7974" y2="196.3047"/><polygon fill="#000000" points="283.5,186.3047,287.5,196.3047,291.5,186.3047,287.5,190.3047" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="287.5" x2="287.5" y1="1158.0491" y2="1168.0491"/><line style="stroke: #000000; stroke-width: 1.5;" x1="287.5" x2="774" y1="1168.0491" y2="1168.0491"/><polygon fill="#000000" points="770,652.6064,774,642.6064,778,652.6064,774,648.6064" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="774" x2="774" y1="145.7974" y2="1168.0491"/><line style="stroke: #000000; stroke-width: 1.5;" x1="774" x2="348.5" y1="145.7974" y2="145.7974"/><polygon fill="#000000" points="358.5,141.7974,348.5,145.7974,358.5,149.7974,354.5,145.7974" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="226.5" x2="24" y1="145.7974" y2="145.7974"/><line style="stroke: #000000; stroke-width: 1.5;" x1="24" x2="24" y1="145.7974" y2="181.7974"/><polygon fill="#000000" points="20,171.7974,24,181.7974,28,171.7974,24,175.7974" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="287.5" x2="287.5" y1="109.5654" y2="133.7974"/><polygon fill="#000000" points="283.5,123.7974,287.5,133.7974,291.5,123.7974,287.5,127.7974" style="stroke: #000000; stroke-width: 1.0;"/><!--
@startuml
skinparam BackgroundColor White|White
skinparam ArrowColor Black
skinparam DefaultFontName Roboto Condensed
skinparam TitleFontStyle Bold

skinparam NoteBackgroundColor White
skinparam NoteBorderColor Black

skinparam UsecaseBackgroundColor White
skinparam ActorBackgroundColor White
skinparam UsecaseBorderColor Black
skinparam ActorBorderColor Black

skinparam usecase {
	BackgroundColor<<for now out of scope>> Gray
}

skinparam StateBackgroundColor White
skinparam StateBorderColor Black

skinparam ActivityBackgroundColor White
skinparam ActivityDiamondBackgroundColor White
skinparam ActivityBorderColor Black
skinparam ActivityDiamondBorderColor Black

skinparam ClassBackgroundColor White
skinparam ClassBorderColor Black
hide empty members

title Nuspell - Result Cache

start

:initialize cache for entry type and maximum entries;
note right
Use each cache for only on type of entries,
do not mix spell/suggest usage.
end note

while (application is running?) is (yes)

:external request is received for spell/suggest for a word (the key);
partition "**get the value for this key from the cache**" {
	if (cache has key?) then (yes)
		:get value for key;
		:increment count for key;
		:set timestamp for key to now;
	else (no)
		:return empty result;
	endif
}
if (a non-empty value got returned?) then (yes)
	:return that value to
the external request;
else (no)
	:get the value from spell/suggest method for this key;
	fork
		:return that value to
the external request;
	fork again
		partition "**add the value for this key to the cache**" {
			if (cache is at maximum?) then (yes)
				:get X cache entries with lowest count,
oldest timestamp and sorted on key;
				note right
Sorting key is for
constant behaviour.
				end note
				:delete these entries;
			else (no)
			endif
			:add value for key;
			:set count for key to 1;
			:set timestamp for key to now;
		}
	end fork
endif

endwhile(no)

stop

@enduml

PlantUML version 1.2018.12beta6(Unknown compile time)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 10.0.2+13-Ubuntu-1ubuntu0.18.04.2
Operating System: Linux
OS Version: 4.15.0-36-generic
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>