<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1185px" preserveAspectRatio="none" style="width:808px;height:1185px;" version="1.1" viewBox="0 0 808 1185" width="808px" zoomAndPan="magnify"><defs><linearGradient id="g19jo8q2jqnk4l0" x1="0%" x2="100%" y1="50%" y2="50%"><stop offset="0%" stop-color="#FFFFFF"/><stop offset="100%" stop-color="#FFFFFF"/></linearGradient><filter height="300%" id="f19jo8q2jqnk4l" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="url(#g19jo8q2jqnk4l0)" height="1185" style="stroke: none; stroke-width: 1.0;" width="808" x="0" y="0"/><text fill="#000000" font-family="Roboto Condensed" font-size="18" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="166" x="320" y="28.8613">Nuspell - Result Cache</text><ellipse cx="287.5" cy="43.7393" fill="#000000" filter="url(#f19jo8q2jqnk4l)" rx="10" ry="10" style="stroke: none; stroke-width: 1.0;"/><path d="M443.5,69.5073 L443.5,87.6523 L423.5,91.6523 L443.5,95.6523 L443.5,113.7974 A0,0 0 0 0 443.5,113.7974 L680.5,113.7974 A0,0 0 0 0 680.5,113.7974 L680.5,79.5073 L670.5,69.5073 L443.5,69.5073 A0,0 0 0 0 443.5,69.5073 " fill="#FFFFFF" filter="url(#f19jo8q2jqnk4l)" style="stroke: #000000; stroke-width: 1.0;"/><path d="M670.5,69.5073 L670.5,79.5073 L680.5,79.5073 L670.5,69.5073 " fill="#FFFFFF" style="stroke: #000000; stroke-width: 1.0;"/><text fill="#000000" font-family="Roboto Condensed" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="216" x="449.5" y="88.1294">Use each cache for only on type of entries,</text><text fill="#000000" font-family="Roboto Condensed" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="163" x="449.5" y="105.2744">do not mix spell/suggest usage.</text><rect fill="#FFFFFF" filter="url(#f19jo8q2jqnk4l)" height="35.8262" rx="12.5" ry="12.5" style="stroke: #000000; stroke-width: 1.5;" width="272" x="151.5" y="73.7393"/><text fill="#000000" font-family="Roboto Condensed" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="252" x="161.5" y="96.3135">initialize cache for entry type and maximum entries</text><rect fill="#FFFFFF" filter="url(#f19jo8q2jqnk4l)" height="35.8262" rx="12.5" ry="12.5" style="stroke: #000000; stroke-width: 1.5;" width="340" x="117.5" y="192.0728"/><text fill="#000000" font-family="Roboto Condensed" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="320" x="127.5" y="214.647">external request is received for spell/suggest for a word (the key)</text><rect fill="#FFFFFF" filter="url(#f19jo8q2jqnk4l)" height="260.6484" style="stroke: #000000; stroke-width: 2.0;" width="336" x="107.5" y="239.1929"/><path d="M344.5,240.1929 L344.5,250.6567 L334.5,260.6567 L107.5,260.6567 " fill="none" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="Roboto Condensed" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="227" x="110.5" y="254.8628">get the value for this key from the cache</text><polygon fill="#FFFFFF" filter="url(#f19jo8q2jqnk4l)" points="254.5,276.3628,320.5,276.3628,332.5,288.3628,320.5,300.3628,254.5,300.3628,242.5,288.3628,254.5,276.3628" style="stroke: #000000; stroke-width: 1.5;"/><text fill="#000000" font-family="Roboto Condensed" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="66" x="254.5" y="292.6355">cache has key?</text><text fill="#000000" font-family="Roboto Condensed" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="15" x="227.5" y="285.3818">yes</text><text fill="#000000" font-family="Roboto Condensed" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="11" x="332.5" y="285.3818">no</text><rect fill="#FFFFFF" filter="url(#f19jo8q2jqnk4l)" height="35.8262" rx="12.5" ry="12.5" style="stroke: #000000; stroke-width: 1.5;" width="101" x="158" y="310.3628"/><text fill="#000000" font-family="Roboto Condensed" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="81" x="168" y="332.937">get value for key</text><rect fill="#FFFFFF" filter="url(#f19jo8q2jqnk4l)" height="35.8262" rx="12.5" ry="12.5" style="stroke: #000000; stroke-width: 1.5;" width="137" x="140" y="366.189"/><text fill="#000000" font-family="Roboto Condensed" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="117" x="150" y="388.7632">increment count for key</text><rect fill="#FFFFFF" filter="url(#f19jo8q2jqnk4l)" height="35.8262" rx="12.5" ry="12.5" style="stroke: #000000; stroke-width: 1.5;" width="162" x="127.5" y="422.0151"/><text fill="#000000" font-family="Roboto Condensed" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="142" x="137.5" y="444.5894">set timestamp for key to now</text><rect fill="#FFFFFF" filter="url(#f19jo8q2jqnk4l)" height="35.8262" rx="12.5" ry="12.5" style="stroke: #000000; stroke-width: 1.5;" width="114" x="309.5" y="310.3628"/><text fill="#000000" font-family="Roboto Condensed" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="94" x="319.5" y="332.937">return empty result</text><polygon fill="#FFFFFF" filter="url(#f19jo8q2jqnk4l)" points="287.5,463.8413,299.5,475.8413,287.5,487.8413,275.5,475.8413,287.5,463.8413" style="stroke: #000000; stroke-width: 1.5;"/><polygon fill="#FFFFFF" filter="url(#f19jo8q2jqnk4l)" points="218.5,519.8413,356.5,519.8413,368.5,531.8413,356.5,543.8413,218.5,543.8413,206.5,531.8413,218.5,519.8413" style="stroke: #000000; stroke-width: 1.5;"/><text fill="#000000" font-family="Roboto Condensed" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="138" x="218.5" y="536.114">a non-empty value got returned?</text><text fill="#000000" font-family="Roboto Condensed" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="15" x="191.5" y="528.8604">yes</text><text fill="#000000" font-family="Roboto Condensed" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="11" x="368.5" y="528.8604">no</text><rect fill="#FFFFFF" filter="url(#f19jo8q2jqnk4l)" height="51.6523" rx="12.5" ry="12.5" style="stroke: #000000; stroke-width: 1.5;" width="119" x="44" y="553.8413"/><text fill="#000000" font-family="Roboto Condensed" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="95" x="54" y="576.4155">return that value to</text><text fill="#000000" font-family="Roboto Condensed" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="99" x="54" y="592.2417">the external request</text><rect fill="#FFFFFF" filter="url(#f19jo8q2jqnk4l)" height="35.8262" rx="12.5" ry="12.5" style="stroke: #000000; stroke-width: 1.5;" width="275" x="334" y="553.8413"/><text fill="#000000" font-family="Roboto Condensed" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="255" x="344" y="576.4155">get the value from spell/suggest method for this key</text><rect fill="#000000" filter="url(#f19jo8q2jqnk4l)" height="6" rx="2.5" ry="2.5" style="stroke: #000000; stroke-width: 1.0;" width="577" x="183" y="624.6675"/><rect fill="#FFFFFF" filter="url(#f19jo8q2jqnk4l)" height="51.6523" rx="12.5" ry="12.5" style="stroke: #000000; stroke-width: 1.5;" width="119" x="197" y="864.0984"/><text fill="#000000" font-family="Roboto Condensed" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="95" x="207" y="886.6726">return that value to</text><text fill="#000000" font-family="Roboto Condensed" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="99" x="207" y="902.4988">the external request</text><rect fill="#FFFFFF" filter="url(#f19jo8q2jqnk4l)" height="444.5618" style="stroke: #000000; stroke-width: 2.0;" width="402" x="344" y="650.6675"/><path d="M568,651.6675 L568,662.1313 L558,672.1313 L344,672.1313 " fill="none" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="Roboto Condensed" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="214" x="347" y="666.3374">add the value for this key to the cache</text><path d="M592,740.7722 L592,758.9172 L572,762.9172 L592,766.9172 L592,785.0623 A0,0 0 0 0 592,785.0623 L714,785.0623 A0,0 0 0 0 714,785.0623 L714,750.7722 L704,740.7722 L592,740.7722 A0,0 0 0 0 592,740.7722 " fill="#FFFFFF" filter="url(#f19jo8q2jqnk4l)" style="stroke: #000000; stroke-width: 1.0;"/><path d="M704,740.7722 L704,750.7722 L714,750.7722 L704,740.7722 " fill="#FFFFFF" style="stroke: #000000; stroke-width: 1.0;"/><text fill="#000000" font-family="Roboto Condensed" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="87" x="598" y="759.3943">Sorting key is for</text><text fill="#000000" font-family="Roboto Condensed" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="101" x="598" y="776.5393">constant behaviour.</text><rect fill="#FFFFFF" filter="url(#f19jo8q2jqnk4l)" height="51.6523" rx="12.5" ry="12.5" style="stroke: #000000; stroke-width: 1.5;" width="208" x="364" y="737.0911"/><text fill="#000000" font-family="Roboto Condensed" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="188" x="374" y="759.6653">get X cache entries with lowest count,</text><text fill="#000000" font-family="Roboto Condensed" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="174" x="374" y="775.4915">oldest timestamp and sorted on key</text><rect fill="#FFFFFF" filter="url(#f19jo8q2jqnk4l)" height="35.8262" rx="12.5" ry="12.5" style="stroke: #000000; stroke-width: 1.5;" width="118" x="409" y="818.3303"/><text fill="#000000" font-family="Roboto Condensed" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="98" x="419" y="840.9045">delete these entries</text><polygon fill="#FFFFFF" filter="url(#f19jo8q2jqnk4l)" points="419.5,687.8374,516.5,687.8374,528.5,699.8374,516.5,711.8374,419.5,711.8374,407.5,699.8374,419.5,687.8374" style="stroke: #000000; stroke-width: 1.5;"/><text fill="#000000" font-family="Roboto Condensed" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="15" x="472" y="723.3638">yes</text><text fill="#000000" font-family="Roboto Condensed" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="97" x="419.5" y="704.1101">cache is at maximum?</text><text fill="#000000" font-family="Roboto Condensed" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="11" x="528.5" y="696.8564">no</text><polygon fill="#FFFFFF" filter="url(#f19jo8q2jqnk4l)" points="468,879.4102,480,891.4102,468,903.4102,456,891.4102,468,879.4102" style="stroke: #000000; stroke-width: 1.5;"/><rect fill="#FFFFFF" filter="url(#f19jo8q2jqnk4l)" height="35.8262" rx="12.5" ry="12.5" style="stroke: #000000; stroke-width: 1.5;" width="103" x="416.5" y="935.7507"/><text fill="#000000" font-family="Roboto Condensed" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="83" x="426.5" y="958.325">add value for key</text><rect fill="#FFFFFF" filter="url(#f19jo8q2jqnk4l)" height="35.8262" rx="12.5" ry="12.5" style="stroke: #000000; stroke-width: 1.5;" width="124" x="406" y="991.5769"/><text fill="#000000" font-family="Roboto Condensed" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="104" x="416" y="1014.1511">set count for key to 1</text><rect fill="#FFFFFF" filter="url(#f19jo8q2jqnk4l)" height="35.8262" rx="12.5" ry="12.5" style="stroke: #000000; stroke-width: 1.5;" width="162" x="387" y="1047.4031"/><text fill="#000000" font-family="Roboto Condensed" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="142" x="397" y="1069.9773">set timestamp for key to now</text><rect fill="#000000" filter="url(#f19jo8q2jqnk4l)" height="6" rx="2.5" ry="2.5" style="stroke: #000000; stroke-width: 1.0;" width="577" x="183" y="1115.2292"/><polygon fill="#FFFFFF" filter="url(#f19jo8q2jqnk4l)" points="287.5,1127.2292,299.5,1139.2292,287.5,1151.2292,275.5,1139.2292,287.5,1127.2292" style="stroke: #000000; stroke-width: 1.5;"/><polygon fill="#FFFFFF" filter="url(#f19jo8q2jqnk4l)" points="238.5,129.5654,336.5,129.5654,348.5,141.5654,336.5,153.5654,238.5,153.5654,226.5,141.5654,238.5,129.5654" style="stroke: #000000; stroke-width: 1.5;"/><text fill="#000000" font-family="Roboto Condensed" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="15" x="291.5" y="165.0918">yes</text><text fill="#000000" font-family="Roboto Condensed" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="98" x="238.5" y="145.8381">application is running?</text><text fill="#000000" font-family="Roboto Condensed" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="11" x="215.5" y="138.5845">no</text><ellipse cx="24" cy="187.5654" fill="none" filter="url(#f19jo8q2jqnk4l)" rx="10" ry="10" style="stroke: #000000; stroke-width: 1.0;"/><ellipse cx="24.5" cy="188.0654" fill="#000000" filter="url(#f19jo8q2jqnk4l)" rx="6" ry="6" style="stroke: none; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="287.5" x2="287.5" y1="53.7393" y2="73.7393"/><polygon fill="#000000" points="283.5,63.7393,287.5,73.7393,291.5,63.7393,287.5,67.7393" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="208.5" x2="208.5" y1="346.189" y2="366.189"/><polygon fill="#000000" points="204.5,356.189,208.5,366.189,212.5,356.189,208.5,360.189" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="208.5" x2="208.5" y1="402.0151" y2="422.0151"/><polygon fill="#000000" points="204.5,412.0151,208.5,422.0151,212.5,412.0151,208.5,416.0151" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="242.5" x2="208.5" y1="288.3628" y2="288.3628"/><line style="stroke: #000000; stroke-width: 1.5;" x1="208.5" x2="208.5" y1="288.3628" y2="310.3628"/><polygon fill="#000000" points="204.5,300.3628,208.5,310.3628,212.5,300.3628,208.5,304.3628" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="332.5" x2="366.5" y1="288.3628" y2="288.3628"/><line style="stroke: #000000; stroke-width: 1.5;" x1="366.5" x2="366.5" y1="288.3628" y2="310.3628"/><polygon fill="#000000" points="362.5,300.3628,366.5,310.3628,370.5,300.3628,366.5,304.3628" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="208.5" x2="208.5" y1="457.8413" y2="475.8413"/><line style="stroke: #000000; stroke-width: 1.5;" x1="208.5" x2="275.5" y1="475.8413" y2="475.8413"/><polygon fill="#000000" points="265.5,471.8413,275.5,475.8413,265.5,479.8413,269.5,475.8413" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="366.5" x2="366.5" y1="346.189" y2="475.8413"/><line style="stroke: #000000; stroke-width: 1.5;" x1="366.5" x2="299.5" y1="475.8413" y2="475.8413"/><polygon fill="#000000" points="309.5,471.8413,299.5,475.8413,309.5,479.8413,305.5,475.8413" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="287.5" x2="287.5" y1="227.8989" y2="276.3628"/><polygon fill="#000000" points="283.5,266.3628,287.5,276.3628,291.5,266.3628,287.5,270.3628" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="468" x2="468" y1="788.7434" y2="818.3303"/><polygon fill="#000000" points="464,808.3303,468,818.3303,472,808.3303,468,812.3303" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="468" x2="468" y1="711.8374" y2="737.0911"/><polygon fill="#000000" points="464,727.0911,468,737.0911,472,727.0911,468,731.0911" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="528.5" x2="724" y1="699.8374" y2="699.8374"/><polygon fill="#000000" points="720,788.3303,724,798.3303,728,788.3303,724,792.3303" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="724" x2="724" y1="699.8374" y2="891.4102"/><line style="stroke: #000000; stroke-width: 1.5;" x1="724" x2="480" y1="891.4102" y2="891.4102"/><polygon fill="#000000" points="490,887.4102,480,891.4102,490,895.4102,486,891.4102" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="468" x2="468" y1="854.1565" y2="879.4102"/><polygon fill="#000000" points="464,869.4102,468,879.4102,472,869.4102,468,873.4102" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="468" x2="468" y1="903.4102" y2="935.7507"/><polygon fill="#000000" points="464,925.7507,468,935.7507,472,925.7507,468,929.7507" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="468" x2="468" y1="971.5769" y2="991.5769"/><polygon fill="#000000" points="464,981.5769,468,991.5769,472,981.5769,468,985.5769" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="468" x2="468" y1="1027.4031" y2="1047.4031"/><polygon fill="#000000" points="464,1037.4031,468,1047.4031,472,1037.4031,468,1041.4031" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="256.5" x2="256.5" y1="630.6675" y2="864.0984"/><polygon fill="#000000" points="252.5,854.0984,256.5,864.0984,260.5,854.0984,256.5,858.0984" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="468" x2="468" y1="630.6675" y2="687.8374"/><polygon fill="#000000" points="464,677.8374,468,687.8374,472,677.8374,468,681.8374" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="256.5" x2="256.5" y1="915.7507" y2="1115.2292"/><polygon fill="#000000" points="252.5,1105.2292,256.5,1115.2292,260.5,1105.2292,256.5,1109.2292" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="468" x2="468" y1="1083.2292" y2="1115.2292"/><polygon fill="#000000" points="464,1105.2292,468,1115.2292,472,1105.2292,468,1109.2292" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="471.5" x2="471.5" y1="589.6675" y2="624.6675"/><polygon fill="#000000" points="467.5,614.6675,471.5,624.6675,475.5,614.6675,471.5,618.6675" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="206.5" x2="103.5" y1="531.8413" y2="531.8413"/><line style="stroke: #000000; stroke-width: 1.5;" x1="103.5" x2="103.5" y1="531.8413" y2="553.8413"/><polygon fill="#000000" points="99.5,543.8413,103.5,553.8413,107.5,543.8413,103.5,547.8413" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="368.5" x2="471.5" y1="531.8413" y2="531.8413"/><line style="stroke: #000000; stroke-width: 1.5;" x1="471.5" x2="471.5" y1="531.8413" y2="553.8413"/><polygon fill="#000000" points="467.5,543.8413,471.5,553.8413,475.5,543.8413,471.5,547.8413" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="103.5" x2="103.5" y1="605.4937" y2="1139.2292"/><line style="stroke: #000000; stroke-width: 1.5;" x1="103.5" x2="275.5" y1="1139.2292" y2="1139.2292"/><polygon fill="#000000" points="265.5,1135.2292,275.5,1139.2292,265.5,1143.2292,269.5,1139.2292" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="471.5" x2="471.5" y1="1121.2292" y2="1139.2292"/><line style="stroke: #000000; stroke-width: 1.5;" x1="471.5" x2="299.5" y1="1139.2292" y2="1139.2292"/><polygon fill="#000000" points="309.5,1135.2292,299.5,1139.2292,309.5,1143.2292,305.5,1139.2292" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="287.5" x2="287.5" y1="487.8413" y2="519.8413"/><polygon fill="#000000" points="283.5,509.8413,287.5,519.8413,291.5,509.8413,287.5,513.8413" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="287.5" x2="287.5" y1="153.5654" y2="192.0728"/><polygon fill="#000000" points="283.5,182.0728,287.5,192.0728,291.5,182.0728,287.5,186.0728" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="287.5" x2="287.5" y1="1151.2292" y2="1161.2292"/><line style="stroke: #000000; stroke-width: 1.5;" x1="287.5" x2="782" y1="1161.2292" y2="1161.2292"/><polygon fill="#000000" points="778,647.0806,782,637.0806,786,647.0806,782,643.0806" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="782" x2="782" y1="141.5654" y2="1161.2292"/><line style="stroke: #000000; stroke-width: 1.5;" x1="782" x2="348.5" y1="141.5654" y2="141.5654"/><polygon fill="#000000" points="358.5,137.5654,348.5,141.5654,358.5,145.5654,354.5,141.5654" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="226.5" x2="24" y1="141.5654" y2="141.5654"/><line style="stroke: #000000; stroke-width: 1.5;" x1="24" x2="24" y1="141.5654" y2="177.5654"/><polygon fill="#000000" points="20,167.5654,24,177.5654,28,167.5654,24,171.5654" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="287.5" x2="287.5" y1="109.5654" y2="129.5654"/><polygon fill="#000000" points="283.5,119.5654,287.5,129.5654,291.5,119.5654,287.5,123.5654" style="stroke: #000000; stroke-width: 1.0;"/><!--
@startuml
skinparam BackgroundColor White|White
skinparam ArrowColor Black
skinparam DefaultFontName Roboto Condensed
skinparam TitleFontStyle Bold

skinparam NoteBackgroundColor White
skinparam NoteBorderColor Black

skinparam UsecaseBackgroundColor White
skinparam ActorBackgroundColor White
skinparam UsecaseBorderColor Black
skinparam ActorBorderColor Black

skinparam usecase {
	BackgroundColor<<for now out of scope>> Gray
}

skinparam StateBackgroundColor White
skinparam StateBorderColor Black

skinparam ActivityBackgroundColor White
skinparam ActivityDiamondBackgroundColor White
skinparam ActivityBorderColor Black
skinparam ActivityDiamondBorderColor Black

skinparam ClassBackgroundColor White
skinparam ClassBorderColor Black
hide empty members

title Nuspell - Result Cache

start

:initialize cache for entry type and maximum entries;
note right
Use each cache for only on type of entries,
do not mix spell/suggest usage.
end note

while (application is running?) is (yes)

:external request is received for spell/suggest for a word (the key);
partition "**get the value for this key from the cache**" {
	if (cache has key?) then (yes)
		:get value for key;
		:increment count for key;
		:set timestamp for key to now;
	else (no)
		:return empty result;
	endif
}
if (a non-empty value got returned?) then (yes)
	:return that value to
the external request;
else (no)
	:get the value from spell/suggest method for this key;
	fork
		:return that value to
the external request;
	fork again
		partition "**add the value for this key to the cache**" {
			if (cache is at maximum?) then (yes)
				:get X cache entries with lowest count,
oldest timestamp and sorted on key;
				note right
Sorting key is for
constant behaviour.
				end note
				:delete these entries;
			else (no)
			endif
			:add value for key;
			:set count for key to 1;
			:set timestamp for key to now;
		}
	end fork
endif

endwhile(no)

stop

@enduml

PlantUML version 1.2018.06(Mon May 21 12:34:53 CEST 2018)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 10.0.2+13-Ubuntu-1ubuntu0.18.04.2
Operating System: Linux
OS Version: 4.15.0-34-generic
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>